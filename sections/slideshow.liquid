{% comment %} Defining schema for Shopify Theme Editor {% endcomment %}
{% schema %}
{
  "name": "Slideshow",
  "settings": [
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Image 1"
    },
    {
      "type": "text",
      "id": "title_1",
      "label": "Title 1",
      "default": "Slide 1"
    },
    {
      "type": "text",
      "id": "subtitle_1",
      "label": "Subtitle 1",
      "default": "Description for slide 1"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Image 2"
    },
    {
      "type": "text",
      "id": "title_2",
      "label": "Title 2",
      "default": "Slide 2"
    },
    {
      "type": "text",
      "id": "subtitle_2",
      "label": "Subtitle 2",
      "default": "Description for slide 2"
    }
  ],
  "presets": [
    {
      "name": "Slideshow",
      "category": "Custom"
    }
  ]
}
{% endschema %}

{% comment %} Styles for slideshow with slide animation and dots {% endcomment %}
<style>
  .slideshow-container {
    min-width: 100vw;
    height: calc(100vh - 64px);
    position: relative;
    margin: auto;
    overflow: hidden;
    margin-top: 64px;
  }
  .slides-wrapper {
    display: flex;
    width: 100%;
    height: 100%;
    transition: transform 0.6s ease-in-out;
  }
  .slide {
    flex: 0 0 100%;
    width: 100%;
    height: 100%;
    position: relative;
  }
  .slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .slide-content {
    position: absolute;
    bottom: 60px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    color: white;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.6);
    animation: slideUp 0.8s ease-out;
  }
  .slide-content h2 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    opacity: 0;
    animation: fadeIn 1s ease-out forwards;
    animation-delay: 0.3s;
  }
  .slide-content p {
    font-size: 1.2rem;
    opacity: 0;
    animation: fadeIn 1s ease-out forwards;
    animation-delay: 0.5s;
  }
  .dots-container {
    text-align: center;
    position: absolute;
    bottom: 20px;
    width: 100%;
  }
  .dot {
    cursor: pointer;
    height: 12px;
    width: 12px;
    margin: 0 5px;
    background-color: #bbb;
    border-radius: 50%;
    display: inline-block;
    transition: background-color 0.3s ease, transform 0.3s ease;
  }
  .dot.active {
    background-color: #fff;
    transform: scale(1.2);
  }
  @keyframes slideUp {
    from {
      transform: translateX(-50%) translateY(50px);
      opacity: 0;
    }
    to {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>

{% comment %} Slideshow HTML structure {% endcomment %}
<div class="slideshow-container">
  <div class="slides-wrapper">
    {% if section.settings.image_1 %}
      <div class="slide">
        <img src="{{ section.settings.image_1 | img_url: 'master' }}" alt="{{ section.settings.title_1 }}">
        <div class="slide-content">
          {% comment %} <h2>{{ section.settings.title_1 }}</h2>
          <p>{{ section.settings.subtitle_1 }}</p> {% endcomment %}
        </div>
      </div>
    {% endif %}
    {% if section.settings.image_2 %}
      <div class="slide">
        <img src="{{ section.settings.image_2 | img_url: 'master' }}" alt="{{ section.settings.title_2 }}">
        <div class="slide-content">
          {% comment %} <h2>{{ section.settings.title_2 }}</h2>
          <p>{{ section.settings.subtitle_2 }}</p> {% endcomment %}
        </div>
      </div>
    {% endif %}
  </div>
  <div class="dots-container">
    {% if section.settings.image_1 %}
      <span class="dot" onclick="currentSlide(1)"></span>
    {% endif %}
    {% if section.settings.image_2 %}
      <span class="dot" onclick="currentSlide(2)"></span>
    {% endif %}
  </div>
</div>

{% comment %} JavaScript for slideshow functionality with dots {% endcomment %}
<script>
  let slideIndex = 1;
  showSlides(slideIndex);

  function currentSlide(n) {
    showSlides(slideIndex = n);
  }

  function showSlides(n) {
    let slidesWrapper = document.querySelector(".slides-wrapper");
    let slides = document.getElementsByClassName("slide");
    let dots = document.getElementsByClassName("dot");
    
    if (n > slides.length) { slideIndex = 1 }
    if (n < 1) { slideIndex = slides.length }
    
    // Update slide position
    slidesWrapper.style.transform = `translateX(-${(slideIndex - 1) * 100}%)`;
    
    // Update active dot
    for (let i = 0; i < dots.length; i++) {
      dots[i].classList.remove("active");
    }
    dots[slideIndex-1].classList.add("active");
  }

  // Auto slide
  setInterval(() => {
    slideIndex++;
    showSlides(slideIndex);
  }, 5000);
</script>